<!doctype html>

<meta charset="utf-8">

<body>
<script>

function setup (heightmap) {
  im = new Image;
  im.src = heightmap;
  im.onload = setCanvas;
  document.body.appendChild(im);
}

function setCanvas() {
  c = document.createElement("canvas")
  c.height = im.height;
  c.width = im.width;
  context = c.getContext("2d")
  check();
}

function checker (url) {
  var max = 0;
  var x = 0, y = 0, el = 0;

  function check () {
    var r, g, b, a, idx;
    context.drawImage(im,0,0);
    width = context.canvas.width;
    height = context.canvas.height;
    data0 = context.getImageData(0,0,width,height);
    data = data0.data;
    for (var j = 0; j < height; j++) {
      for (var i = 0; i < width; i++) {
        idx = j * height * 4 + i * 4;
        r = data[idx];
        g = data[idx+1];
        b = data[idx+2];
        a = data[idx+3];
        el = r * 256 + g;
        if (el > max) {
          max = el;
          x = i;
          y = j;
        }
      }
    }
    reportResult();
  }

  function reportResult () {
    var result = document.createElement("p")
    result.innerHTML = "max elevation: " + max + " m" +
    '<br> at pt ' + x + ' ' + y;
    document.body.appendChild(result);
  }
  return check;
}



  </script>
